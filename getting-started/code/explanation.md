# Explanation of the Code

This code has two main parts: creating a database of documents and querying that database to find relevant information. Below, I will break down what each part of the code does.

## 1. `create_database.py` - Creating a Database

### Purpose:
The purpose of this script is to read all documents from a folder, split the text into smaller pieces, and store them in a database (Chroma). This will allow you to later search the database for specific information.

### Main Steps:
1. **Loading Documents:**
   - The code first loads all the markdown files (`*.md`) from a folder called `data/vestibulares`.
   - It uses the `DirectoryLoader` to do this. A `loader` object is created to get all files in the folder.

2. **Splitting the Text:**
   - Once the documents are loaded, they are split into smaller pieces or "chunks". This is done by the `text_splitter` (specifically the `RecursiveCharacterTextSplitter`), which breaks the text into pieces that are easier to work with.
   - The chunks are set to be no longer than 1000 characters, with 500 characters overlapping between each chunk, so that the context doesn’t get lost.

3. **Saving to the Database:**
   - The split chunks are then saved into a database called Chroma. Chroma helps store and search these chunks.
   - Before saving, it checks if there is already a database folder. If there is, it deletes it and creates a new one.

4. **How the Text is Split:**
   - When splitting, it uses the `RecursiveCharacterTextSplitter` to break down large pieces of text into smaller, manageable parts. Each chunk will contain parts of the original documents, making it easier for the AI to search through the text later.

### Functions in the Script:
- `load_documents()`: Loads all documents from the `data/vestibulares` folder.
- `split_text()`: Splits each document into smaller chunks.
- `save_to_chroma()`: Saves the chunks into the Chroma database.

---

## 2. `query_data.py` - Searching the Database

### Purpose:
This script allows you to ask a question (a query) and search through the database (created in the previous step) to find relevant information.

### Main Steps:
1. **Setting Up the Query:**
   - The code takes a question from the user (this is done through the command line when running the script).
   
2. **Preparing the Database:**
   - It loads the Chroma database, which contains all the chunks of text that were saved in the previous script.
   - The `embedding_function` is used to transform the query and chunks of text into vectors (numerical representations), which makes it easier to compare the question with the stored chunks.

3. **Searching the Database:**
   - The code then searches for the most relevant chunks in the database. It looks for chunks that are similar to the query (using `similarity_search_with_relevance_scores`).
   - It retrieves the top 3 most relevant chunks that best match the query.

4. **Generating the Response:**
   - The relevant chunks are combined into a context.
   - The AI model (OpenAI’s Chat) is then used to create a response based on the context and the question.

5. **Displaying the Answer:**
   - The answer generated by the AI is shown to the user along with the sources (documents) that were used to generate the response.

### Functions in the Script:
- `main()`: This is the main function that runs the process. It takes the user's query, prepares the database, and generates a response.
- `search_database()`: Searches for similar chunks in the database based on the query.
- `generate_answer()`: Uses the AI model to generate an answer based on the context.

---

## Summary:

### `create_database.py`
- Loads all markdown documents.
- Splits the documents into small chunks.
- Saves these chunks into a Chroma database for easy searching.

### `query_data.py`
- Takes a user’s query.
- Searches through the Chroma database for relevant chunks of text.
- Generates a response based on the found information and displays it.

This setup is useful for building systems that need to answer questions based on a large amount of text, like creating a chatbot that can help students with exam information or any other specific topic.

### How It All Works Together:
1. **Step 1**: First, run `create_database.py` to load and store documents.
2. **Step 2**: After that, use `query_data.py` to ask questions and get answers from the stored documents.

This is a basic version of a question-answering system where the AI gives answers based on specific data that has been stored beforehand.
